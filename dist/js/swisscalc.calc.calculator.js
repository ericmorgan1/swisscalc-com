var swisscalc=swisscalc||{};swisscalc.calc=swisscalc.calc||{},swisscalc.calc.calculator=function(){this._state=0,this._evaluator=new swisscalc.lib.shuntingYard,this._mainDisplay=new swisscalc.display.numericDisplay,this._memoryDisplay=new swisscalc.display.memoryDisplay},swisscalc.calc.calculator.STATE_AWAITING_OPERAND=0,swisscalc.calc.calculator.STATE_AWAITING_OPERATOR=0,swisscalc.calc.calculator.STATE_ENTERING_OPERAND=1,swisscalc.calc.calculator.STATE_ENTERING_OPERATOR=2,swisscalc.calc.calculator.prototype.setState=function(a){this._state=a},swisscalc.calc.calculator.prototype.pushDisplay=function(){var a=this._mainDisplay.getDisplayValue();this._evaluator.addOperand(a)},swisscalc.calc.calculator.prototype.addDigit=function(a){this._state==swisscalc.calc.calculator.STATE_AWAITING_OPERATOR?(this._mainDisplay.clear(),this._mainDisplay.addDigit(a),this.setState(swisscalc.calc.calculator.STATE_ENTERING_OPERAND)):this._state==swisscalc.calc.calculator.STATE_ENTERING_OPERAND?(this._mainDisplay.addDigit(a),this.setState(swisscalc.calc.calculator.STATE_ENTERING_OPERAND)):this._state==swisscalc.calc.calculator.STATE_ENTERING_OPERATOR&&(this._mainDisplay.clear(),this._mainDisplay.addDigit(a),this.setState(swisscalc.calc.calculator.STATE_ENTERING_OPERAND))},swisscalc.calc.calculator.prototype.backspace=function(){this._state==swisscalc.calc.calculator.STATE_AWAITING_OPERATOR?this.setState(swisscalc.calc.calculator.STATE_AWAITING_OPERATOR):this._state==swisscalc.calc.calculator.STATE_ENTERING_OPERAND?(this._mainDisplay.backspace(),this.setState(swisscalc.calc.calculator.STATE_ENTERING_OPERAND)):this._state==swisscalc.calc.calculator.STATE_ENTERING_OPERATOR&&this.setState(swisscalc.calc.calculator.STATE_ENTERING_OPERATOR)},swisscalc.calc.calculator.prototype.clear=function(){this._mainDisplay.clear(),this._evaluator.clear(),this.setState(swisscalc.calc.calculator.STATE_AWAITING_OPERATOR)},swisscalc.calc.calculator.prototype.clearEntry=function(){this._mainDisplay.clear()},swisscalc.calc.calculator.prototype.equalsPressed=function(){this.pushDisplay();var a=this._evaluator.evaluate();this._mainDisplay.setDisplayValue(a),this.setState(swisscalc.calc.calculator.STATE_AWAITING_OPERATOR)},swisscalc.calc.calculator.prototype.openParen=function(){this._evaluator.addOpenParen(swisscalc.lib.operatorCache.OpenParenOperator),this._mainDisplay.clear(),this.setState(swisscalc.calc.calculator.STATE_AWAITING_OPERATOR)},swisscalc.calc.calculator.prototype.closeParen=function(){this._evaluator.inSubExpression()&&(this.pushDisplay(),this._evaluator.addCloseParen(swisscalc.lib.operatorCache.CloseParenOperator),this._mainDisplay.setDisplayValue(this._evaluator.popOperand()),this.setState(swisscalc.calc.calculator.STATE_AWAITING_OPERATOR))},swisscalc.calc.calculator.prototype.addNullaryOperator=function(a){var s=a.evaluate();this._mainDisplay.setDisplayValue(s),this.setState(swisscalc.calc.calculator.STATE_AWAITING_OPERATOR)},swisscalc.calc.calculator.prototype.negate=function(){this._state==swisscalc.calc.calculator.STATE_AWAITING_OPERATOR?this.addUnaryOperator(swisscalc.lib.operatorCache.NegateOperator):this._state==swisscalc.calc.calculator.STATE_ENTERING_OPERAND?(this._mainDisplay.negate(),this.setState(swisscalc.calc.calculator.STATE_ENTERING_OPERAND)):this._state==swisscalc.calc.calculator.STATE_ENTERING_OPERATOR&&this.addUnaryOperator(swisscalc.lib.operatorCache.NegateOperator)},swisscalc.calc.calculator.prototype.addUnaryOperator=function(a){this.pushDisplay(),this._evaluator.addUnaryOperator(a),this._mainDisplay.setDisplayValue(this._evaluator.popOperand()),this.setState(swisscalc.calc.calculator.STATE_AWAITING_OPERATOR)},swisscalc.calc.calculator.prototype.addBinaryOperator=function(a){this._state==swisscalc.calc.calculator.STATE_AWAITING_OPERATOR?(this.pushDisplay(),this._evaluator.addBinaryOperator(a),this._mainDisplay.setDisplayValue(this._evaluator.peekOperand()),this.setState(swisscalc.calc.calculator.STATE_ENTERING_OPERATOR)):this._state==swisscalc.calc.calculator.STATE_ENTERING_OPERAND?(this.pushDisplay(),this._evaluator.addBinaryOperator(a),this._mainDisplay.setDisplayValue(this._evaluator.peekOperand()),this.setState(swisscalc.calc.calculator.STATE_ENTERING_OPERATOR)):this._state==swisscalc.calc.calculator.STATE_ENTERING_OPERATOR&&(this._evaluator.popOperator(),this._evaluator.addBinaryOperator(a),this._mainDisplay.setDisplayValue(this._evaluator.peekOperand()),this.setState(swisscalc.calc.calculator.STATE_ENTERING_OPERATOR))},swisscalc.calc.calculator.prototype.getMainDisplay=function(){return this._mainDisplay.getCurrentDisplay()},swisscalc.calc.calculator.prototype.memoryClear=function(){this._memoryDisplay.memoryClear()},swisscalc.calc.calculator.prototype.memoryPlus=function(){var a=this._mainDisplay.getDisplayValue();this._memoryDisplay.memoryPlus(a)},swisscalc.calc.calculator.prototype.memoryMinus=function(){var a=this._mainDisplay.getDisplayValue();this._memoryDisplay.memoryMinus(a)},swisscalc.calc.calculator.prototype.memorySet=function(){var a=this._mainDisplay.getDisplayValue();this._memoryDisplay.memorySet(a)},swisscalc.calc.calculator.prototype.memoryRecall=function(){if(this._memoryDisplay.hasMemory()){var a=this._memoryDisplay.memoryRecall();this._mainDisplay.setDisplayValue(a),this.setState(swisscalc.calc.calculator.STATE_AWAITING_OPERATOR)}};